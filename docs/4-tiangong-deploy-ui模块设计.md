# Tiangong Deploy UI 模块设计

> 对标 Palantir Apollo 的控制台设计

## 📋 核心模块列表

### 一、基础管理模块（已有/规划中）

#### 1. **环境管理** (Environment Management) ✅
- **功能**：
  - 环境列表（开发、测试、预发布、生产等）
  - 环境连接状态监控（在线/离线/断开连接）
  - 环境配置管理（K8s 集群、网络、认证信息）
  - 环境标签和分组
  - 环境维护窗口设置
  - Air-gapped 环境支持
- **对标 Apollo**：Environments

#### 2. **产品管理** (Product Management) ✅
- **功能**：
  - 产品/应用定义
  - 产品版本管理
  - 产品依赖关系（依赖图）
  - 产品约束定义（版本要求、资源要求等）
  - 产品发布渠道配置
- **对标 Apollo**：Applications/Products

#### 3. **人员管理** (User Management) ✅
- **功能**：
  - 用户账号管理
  - 用户组管理
  - 用户角色分配
  - 用户活动日志
- **对标 Apollo**：Users & Groups

#### 4. **权限管理** (Permission Management) ✅
- **功能**：
  - 基于角色的访问控制（RBAC）
  - 环境级别权限隔离
  - 产品级别权限控制
  - 操作权限（读/写/执行/审批）
  - 权限继承和委托
- **对标 Apollo**：Access Control

---

### 二、部署与发布模块（核心功能）

#### 5. **发布管理** (Release Management) 🎯
- **功能**：
  - 发布版本创建和管理
  - 发布渠道定义（RELEASE → CANARY → STABLE）
  - 发布策略配置（蓝绿部署、金丝雀发布、滚动更新）
  - 发布审批流程
  - 发布历史记录
  - 发布回滚
- **对标 Apollo**：Releases & Release Channels
- **重要性**：⭐⭐⭐⭐⭐

#### 6. **部署管理** (Deployment Management) 🎯
- **功能**：
  - 部署任务创建和执行
  - 部署计划（多环境批量部署）
  - 部署状态实时监控
  - 部署日志查看
  - 部署失败自动重试
  - 部署回滚操作
- **对标 Apollo**：Deployments
- **重要性**：⭐⭐⭐⭐⭐

#### 7. **任务管理** (Task Management) ✅
- **功能**：
  - 任务列表（Shell、SQL、K8s、API、File）
  - 任务执行历史
  - 任务状态跟踪
  - 任务日志实时查看
  - 任务重试和取消
- **当前状态**：已有基础功能
- **重要性**：⭐⭐⭐⭐

#### 8. **Agent 管理** (Agent Management) ✅
- **功能**：
  - Agent 列表和状态监控
  - Agent 健康检查
  - Agent 分组和标签
  - Agent 配置管理
  - Agent 连接日志
- **当前状态**：已有基础功能
- **重要性**：⭐⭐⭐⭐

---

### 三、变更与合规模块

#### 9. **变更管理** (Change Management) 🎯
- **功能**：
  - 变更请求创建
  - 变更审批流程（多级审批）
  - 变更计划（维护窗口）
  - 变更抑制规则（变更冻结期）
  - 变更影响分析
  - 变更执行跟踪
- **对标 Apollo**：Change Management
- **重要性**：⭐⭐⭐⭐⭐

#### 10. **审计日志** (Audit Logs) 🎯
- **功能**：
  - 操作审计日志（谁、何时、做了什么）
  - 变更审计追踪
  - 登录审计
  - 权限变更审计
  - 审计报告生成
  - 审计日志导出
- **对标 Apollo**：Audit & Compliance
- **重要性**：⭐⭐⭐⭐⭐

#### 11. **合规管理** (Compliance Management) 🎯
- **功能**：
  - 合规策略定义（等保、ISO 27001等）
  - 合规检查规则
  - 合规报告生成
  - 合规状态监控
  - 合规违规告警
- **对标 Apollo**：Compliance Framework
- **重要性**：⭐⭐⭐⭐

---

### 四、配置与资源模块

#### 12. **配置管理** (Configuration Management) 🎯
- **功能**：
  - 环境配置管理
  - 产品配置管理
  - 配置版本控制
  - 配置模板管理
  - 配置差异对比
  - 配置同步和分发
- **对标 Apollo**：Configuration Management
- **重要性**：⭐⭐⭐⭐

#### 13. **约束引擎** (Constraint Engine) 🎯
- **功能**：
  - 产品约束定义（依赖关系、版本要求）
  - 环境约束定义（维护窗口、变更限制）
  - 约束验证和协调
  - 约束冲突检测
  - 约束规则管理
- **对标 Apollo**：Constraints
- **重要性**：⭐⭐⭐⭐⭐

#### 14. **资源管理** (Resource Management) 🎯
- **功能**：
  - 计算资源监控（CPU、内存）
  - 存储资源管理
  - 网络资源管理
  - 资源配额管理
  - 资源使用统计
- **重要性**：⭐⭐⭐

---

### 五、监控与可观测性模块

#### 15. **监控告警** (Monitoring & Alerting) 🎯
- **功能**：
  - 系统健康监控
  - Agent 状态监控
  - 部署成功率统计
  - 告警规则配置
  - 告警通知（邮件、钉钉、企业微信）
  - 告警历史记录
- **重要性**：⭐⭐⭐⭐

#### 16. **日志管理** (Log Management) ✅
- **功能**：
  - 集中日志查看
  - 日志搜索和过滤
  - 日志实时流式查看
  - 日志导出
  - 日志归档
- **当前状态**：已有基础功能（WebSocket 实时日志）
- **重要性**：⭐⭐⭐⭐

#### 17. **仪表盘** (Dashboard) 🎯
- **功能**：
  - 系统概览仪表盘
  - 部署统计图表
  - 环境状态总览
  - 任务执行统计
  - 自定义仪表盘
- **重要性**：⭐⭐⭐⭐

---

### 六、工作流与自动化模块

#### 18. **工作流管理** (Workflow Management) 🎯
- **功能**：
  - 工作流定义（部署流程、审批流程）
  - 工作流执行引擎
  - 工作流模板
  - 工作流版本管理
  - 工作流执行历史
- **对标 Apollo**：Orchestration
- **重要性**：⭐⭐⭐⭐

#### 19. **模板管理** (Template Management) 🎯
- **功能**：
  - 部署模板（K8s YAML、SQL 脚本）
  - 配置模板
  - 任务模板
  - 模板版本管理
  - 模板共享和复用
- **重要性**：⭐⭐⭐

#### 20. **自动化规则** (Automation Rules) 🎯
- **功能**：
  - 自动部署规则（基于条件触发）
  - 自动审批规则
  - 自动回滚规则
  - 规则引擎配置
- **对标 Apollo**：Autonomous Deployment
- **重要性**：⭐⭐⭐⭐

---

### 七、文件与存储模块

#### 21. **文件管理** (File Management) ✅
- **功能**：
  - 文件上传和存储
  - 文件分发到 Agent
  - 文件版本管理
  - 文件权限控制
  - 文件使用统计
- **当前状态**：已有基础功能
- **重要性**：⭐⭐⭐

---

### 八、集成与扩展模块

#### 22. **API 管理** (API Management) 🎯
- **功能**：
  - API 密钥管理
  - API 调用统计
  - API 文档
  - API 限流配置
- **重要性**：⭐⭐⭐

#### 23. **集成管理** (Integration Management) 🎯
- **功能**：
  - 外部系统集成（Jenkins、GitLab CI/CD）
  - Webhook 配置
  - 通知集成（邮件、钉钉、企业微信、Slack）
  - SSO 集成（SAML、OAuth）
- **重要性**：⭐⭐⭐⭐

#### 24. **插件管理** (Plugin Management) 🎯
- **功能**：
  - 执行器插件列表
  - 插件配置管理
  - 插件启用/禁用
  - 自定义插件上传
- **重要性**：⭐⭐⭐

---

### 九、通知与协作模块

#### 25. **通知管理** (Notification Management) 🎯
- **功能**：
  - 通知规则配置
  - 通知渠道管理（邮件、钉钉、企业微信、Slack）
  - 通知模板
  - 通知历史记录
- **重要性**：⭐⭐⭐

---

## 📊 模块优先级建议

### P0 - 核心必需（MVP）
1. ✅ 环境管理
2. ✅ 产品管理
3. ✅ 人员管理
4. ✅ 权限管理
5. 🎯 发布管理
6. 🎯 部署管理
7. ✅ 任务管理
8. ✅ Agent 管理
9. 🎯 变更管理
10. 🎯 审计日志

### P1 - 重要功能（第一阶段）
11. 🎯 约束引擎
12. 🎯 配置管理
13. 🎯 监控告警
14. ✅ 日志管理
15. 🎯 仪表盘
16. 🎯 合规管理

### P2 - 增强功能（第二阶段）
17. 🎯 工作流管理
18. 🎯 自动化规则
19. 🎯 模板管理
20. 🎯 集成管理
21. 🎯 通知管理
22. 🎯 资源管理

### P3 - 扩展功能（第三阶段）
23. 🎯 API 管理
24. 🎯 插件管理

---

## 🎯 模块设计原则

1. **对标 Apollo**：核心功能对齐 Palantir Apollo
2. **渐进式开发**：先实现 MVP，再逐步增强
3. **模块化设计**：每个模块独立，便于开发和维护
4. **统一体验**：所有模块使用统一的设计语言和交互模式
5. **可扩展性**：支持插件和自定义扩展

---

## 📝 备注

- ✅ 表示已有基础功能或已规划
- 🎯 表示需要新开发
- 重要性用 ⭐ 数量表示（1-5 星）

